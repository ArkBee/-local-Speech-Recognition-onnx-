# Local Voice Recognition (GigaAM v3)

Этот проект предоставляет возможность локального распознавания речи с использованием моделей **GigaAM v3** от SberDevices, оптимизированных для работы через **ONNX Runtime**.

Проект специально настроен для работы на видеокартах серии **NVIDIA GTX 1080 Ti** (и других с поддержкой CUDA 11.8).

## Особенности
- **Высокая скорость**: Использование ONNX Runtime и обработка аудио в оперативной памяти.
- **GigaAM v3**: Поддержка новейших моделей, включая `v3_e2e_rnnt` с автоматической пунктуацией.
- **Удобство**: Ввод текста напрямую в активное окно (эмуляция клавиатуры).
- **Гибкость**: Переключение моделей и режимов замены текста "на лету".

## Установка

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/ArkBee/local_input.git
   cd local_input
   ```

2. **Создайте виртуальное окружение и активируйте его**:
   ```bash
   python -m venv .venv
   .venv\Scripts\activate
   ```

3. **Установите зависимости**:
   Для корректной работы на GTX 1080 Ti используется PyTorch с CUDA 11.8:
   ```bash
   pip install -r requirements.txt
   ```

4. **Обновите пакет GigaAM**:
   Для поддержки v3 моделей установите последнюю версию из GitHub:
   ```bash
   pip install --upgrade --no-deps git+https://github.com/salute-developers/GigaAM.git
   ```

## Подготовка моделей (Экспорт в ONNX)

Перед первым запуском необходимо экспортировать модели в формат ONNX. Это делается один раз:

```bash
# Экспорт стандартной модели
python export_gigaam_onnx.py --model v3_rnnt

# Экспорт модели с пунктуацией
python export_gigaam_onnx.py --model v3_e2e_rnnt
```
Модели будут сохранены в папку `models/onnx/`.

## Запуск

```bash
python start.py
```

## Управление (Горячие клавиши)

- **`Ctrl + Alt`** (по умолчанию) — **Запись голоса**. Удерживайте для записи, отпустите для распознавания.
- **`Ctrl + Shift + Alt + M`** — **Смена модели** (переключение между `v3_rnnt` и `v3_e2e_rnnt`).
- **`Ctrl + Shift + Alt + R`** — **Вкл/Выкл замены** (цифры "два" -> "2", знаки препинания).
- **`Ctrl + Shift + Alt + L`** — **Перезагрузка конфига** хоткеев из `hotkey_config.txt`.

## Настройка GPU (GTX 1080 Ti)

Если в логах появляется ошибка `LoadLibrary failed with error 126` при загрузке CUDA:
1. Скачайте `zlibwapi.dll` (из состава NVIDIA ZLib).
2. Положите его в `C:\Windows\System32` или в папку `.venv\Lib\site-packages\onnxruntime\capi`.

## Логирование
Все события и результаты распознавания записываются в файл `app.log`.
